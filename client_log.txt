2025-05-02 16:17:11,254 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-02 16:17:11,259 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-02 16:17:11,259 - CipherShare Client - INFO - Listening for file transfers on port 59001
2025-05-02 16:17:11,259 - CipherShare Client - INFO - Starting to listen for file transfers on port 59001
2025-05-02 16:17:17,792 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-02 16:17:17,796 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-02 16:17:17,797 - CipherShare Client - INFO - Listening for file transfers on port 59003
2025-05-02 16:17:17,797 - CipherShare Client - INFO - Starting to listen for file transfers on port 59003
2025-05-02 16:17:37,139 - CipherShare Client - INFO - Logged in as ahmedbaher22
2025-05-02 16:17:39,555 - CipherShare Client - INFO - Session is valid
2025-05-02 16:17:43,582 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-02 16:17:45,255 - CipherShare Client - INFO - Session is valid
2025-05-02 16:17:56,635 - CipherShare Client - INFO - Saved 1 shared files
2025-05-02 16:17:56,635 - CipherShare Client - INFO - File 'test.txt' uploaded successfully
2025-05-02 16:18:00,085 - CipherShare Client - INFO - Session is valid
2025-05-02 16:18:19,215 - CipherShare Client - INFO - Registered as shahd22
2025-05-02 16:18:20,697 - CipherShare Client - INFO - Session is valid
2025-05-02 16:18:25,913 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-02 16:18:28,044 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 59005)
2025-05-02 16:18:28,045 - CipherShare Client - INFO - Handling file transfer request from ('127.0.0.1', 59005)
2025-05-02 16:18:28,045 - CipherShare Client - INFO - Received file source information: {'owner': 'ahmedbaher22', 'ip': '127.0.0.1', 'port': 59001}
2025-05-02 16:18:28,045 - CipherShare Client - INFO - Received file transfer request: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 59002, 'requester_username': 'shahd22', 'filename': 'test.txt'}
2025-05-02 16:18:28,045 - CipherShare Client - INFO - File request notification: shahd22 at 127.0.0.1:59002 will download 'test.txt'
2025-05-02 16:18:28,045 - CipherShare Client - INFO - Connected to file source at 127.0.0.1:59001
2025-05-02 16:18:28,045 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 59006)
2025-05-02 16:18:28,045 - CipherShare Client - INFO - Closed connection with ('127.0.0.1', 59005)
2025-05-02 16:18:28,045 - CipherShare Client - INFO - Sent file transfer request
2025-05-02 16:18:28,046 - CipherShare Client - INFO - Handling file transfer request from ('127.0.0.1', 59006)
2025-05-02 16:18:28,046 - CipherShare Client - INFO - Received file transfer request: {'type': 'FILE_TRANSFER', 'filename': 'test.txt', 'requester_username': 'shahd22'}
2025-05-02 16:18:28,046 - CipherShare Client - INFO - File transfer request for 'test.txt' from shahd22
2025-05-02 16:18:38,051 - CipherShare Client - ERROR - Download error: timed out
2025-05-02 16:18:48,682 - CipherShare Client - INFO - Sent DH initialization
2025-05-02 16:18:48,690 - CipherShare Client - ERROR - File transfer error: [WinError 10053] An established connection was aborted by the software in your host machine
2025-05-02 16:18:48,690 - CipherShare Client - INFO - Closed connection with ('127.0.0.1', 59006)
2025-05-02 16:20:25,699 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-02 16:20:27,189 - CipherShare Client - INFO - Session is valid
2025-05-02 16:20:29,212 - CipherShare Client - INFO - Session is valid
2025-05-02 16:38:30,818 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-02 16:38:30,822 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-02 16:38:30,822 - CipherShare Client - INFO - Listening for file transfers on port 59116
2025-05-02 16:38:30,823 - CipherShare Client - INFO - Starting to listen for file transfers on port 59116
2025-05-02 16:38:34,969 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-02 16:38:34,974 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-02 16:38:34,974 - CipherShare Client - INFO - Listening for file transfers on port 59119
2025-05-02 16:38:34,974 - CipherShare Client - INFO - Starting to listen for file transfers on port 59119
2025-05-02 16:38:46,688 - CipherShare Client - INFO - Logged in as shahd22
2025-05-02 16:38:47,530 - CipherShare Client - INFO - Session is valid
2025-05-02 16:38:56,609 - CipherShare Client - INFO - Logged in as ahmedbaher22
2025-05-02 16:38:57,620 - CipherShare Client - INFO - Session is valid
2025-05-02 16:39:01,631 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-02 16:39:03,064 - CipherShare Client - INFO - Session is valid
2025-05-02 16:39:08,063 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-02 16:39:09,018 - CipherShare Client - INFO - Session is valid
2025-05-02 16:39:21,698 - CipherShare Client - INFO - File 'test.txt' uploaded successfully
2025-05-02 16:39:22,686 - CipherShare Client - INFO - Session is valid
2025-05-02 16:39:26,625 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-02 16:39:28,354 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 59125)
2025-05-02 16:39:28,355 - CipherShare Client - INFO - Received file source information: {'owner': 'ahmedbaher22', 'ip': '127.0.0.1', 'port': 59116}
2025-05-02 16:39:28,355 - CipherShare Client - INFO - Connected to file source at 127.0.0.1:59116
2025-05-02 16:39:28,355 - CipherShare Client - INFO - Handling file transfer request from ('127.0.0.1', 59125)
2025-05-02 16:39:28,355 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 59126)
2025-05-02 16:39:28,355 - CipherShare Client - INFO - Sent file transfer request
2025-05-02 16:39:28,355 - CipherShare Client - INFO - Received file transfer request: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 59118, 'requester_username': 'shahd22', 'filename': 'test.txt'}
2025-05-02 16:39:28,355 - CipherShare Client - INFO - Handling file transfer request from ('127.0.0.1', 59126)
2025-05-02 16:39:28,356 - CipherShare Client - INFO - File request notification: shahd22 at 127.0.0.1:59118 will download 'test.txt'
2025-05-02 16:39:28,356 - CipherShare Client - INFO - Received file transfer request: {'type': 'FILE_TRANSFER', 'filename': 'test.txt', 'requester_username': 'shahd22'}
2025-05-02 16:39:28,356 - CipherShare Client - INFO - Closed connection with ('127.0.0.1', 59125)
2025-05-02 16:39:28,356 - CipherShare Client - INFO - File transfer request for 'test.txt' from shahd22
2025-05-02 16:39:28,373 - CipherShare Client - INFO - Sent DH initialization with public key
2025-05-02 16:39:28,389 - CipherShare Client - INFO - Sent DH response with public key
2025-05-02 16:39:28,389 - CipherShare Client - INFO - Received DH response with peer's public key
2025-05-02 16:39:28,408 - CipherShare Client - INFO - Computed shared key for file encryption
2025-05-02 16:39:28,408 - CipherShare Client - INFO - Sent file hash for integrity verification
2025-05-02 16:39:28,408 - CipherShare Client - INFO - Computed shared key for file encryption
2025-05-02 16:39:28,408 - CipherShare Client - INFO - Received file hash for integrity verification
2025-05-02 16:39:28,428 - CipherShare Client - INFO - Encrypted file 'test.txt' (size: 22 bytes -> 32 bytes)
2025-05-02 16:39:28,429 - CipherShare Client - INFO - Encrypted file 'test.txt' sent to shahd22
2025-05-02 16:39:28,429 - CipherShare Client - INFO - Received encrypted file data: 48 bytes
2025-05-02 16:39:28,429 - CipherShare Client - INFO - Closed connection with ('127.0.0.1', 59126)
2025-05-02 16:39:28,440 - CipherShare Client - INFO - Decrypted file 'test.txt' (size: 22 bytes)
2025-05-02 16:39:28,440 - CipherShare Client - INFO - File integrity verified successfully
2025-05-02 16:39:28,442 - CipherShare Client - INFO - File 'test.txt' uploaded successfully
2025-05-02 16:39:28,442 - CipherShare Client - INFO - File 'test.txt' downloaded and decrypted successfully
2025-05-02 19:46:16,502 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-02 19:46:16,502 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-02 19:46:16,502 - CipherShare Client - INFO - Listening for file transfers on port 58709
2025-05-02 19:46:16,510 - CipherShare Client - INFO - Starting to listen for file transfers on port 58709
2025-05-02 19:46:24,336 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-02 19:46:24,344 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-02 19:46:24,344 - CipherShare Client - INFO - Listening for file transfers on port 58711
2025-05-02 19:46:24,344 - CipherShare Client - INFO - Starting to listen for file transfers on port 58711
2025-05-02 19:46:40,459 - CipherShare Client - INFO - Logged in as ahmedbaher22
2025-05-02 19:46:41,381 - CipherShare Client - INFO - Session is valid
2025-05-02 19:46:53,695 - CipherShare Client - INFO - Logged in as shahd22
2025-05-02 19:46:54,286 - CipherShare Client - INFO - Session is valid
2025-05-02 19:46:56,979 - CipherShare Client - INFO - Retrieved 2 available files
2025-05-02 19:47:02,112 - CipherShare Client - INFO - Session is valid
2025-05-02 19:47:07,717 - CipherShare Client - INFO - Saved 0 shared files
2025-05-02 19:47:07,717 - CipherShare Client - INFO - File 'test.txt' removed successfully
2025-05-02 19:47:08,436 - CipherShare Client - INFO - Session is valid
2025-05-02 19:47:18,890 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-02 19:47:20,523 - CipherShare Client - INFO - ============================================================
2025-05-02 19:47:20,580 - CipherShare Client - INFO - ============================================================
2025-05-02 19:53:46,639 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-02 19:53:46,639 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-02 19:53:46,639 - CipherShare Client - INFO - Listening for file transfers on port 58763
2025-05-02 19:53:46,647 - CipherShare Client - INFO - Starting to listen for file transfers on port 58763
2025-05-02 19:53:56,082 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-02 19:53:56,082 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-02 19:53:56,090 - CipherShare Client - INFO - Listening for file transfers on port 58765
2025-05-02 19:53:56,091 - CipherShare Client - INFO - Starting to listen for file transfers on port 58765
2025-05-02 19:54:10,201 - CipherShare Client - INFO - Logged in as ahmedbaher22
2025-05-02 19:54:11,337 - CipherShare Client - INFO - Session is valid
2025-05-02 19:54:30,881 - CipherShare Client - INFO - Logged in as shahd22
2025-05-02 19:54:31,770 - CipherShare Client - INFO - Session is valid
2025-05-02 19:54:33,936 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-02 19:54:36,952 - CipherShare Client - INFO - Session is valid
2025-05-02 19:54:42,986 - CipherShare Client - INFO - Session is valid
2025-05-02 19:54:52,040 - CipherShare Client - INFO - Saved 1 shared files
2025-05-02 19:54:52,040 - CipherShare Client - INFO - File 'test.txt' uploaded successfully
2025-05-02 19:54:53,415 - CipherShare Client - INFO - Session is valid
2025-05-02 19:54:56,735 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-02 19:54:57,992 - CipherShare Client - INFO - Session is valid
2025-05-02 19:54:59,516 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-02 19:55:00,764 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:00,764 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-02 19:55:00,764 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:00,764 - CipherShare Client - INFO -  Sending download request to server
2025-05-02 19:55:00,764 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 58770)
2025-05-02 19:55:00,764 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:00,764 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-02 19:55:00,764 - CipherShare Client - INFO -  Server provided file source: ahmedbaher22 at 127.0.0.1:58765
2025-05-02 19:55:00,764 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:00,764 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 58770)
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Received request of type: FILE_INFO
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  File request notification: shahd22 at 127.0.0.1:58762 will download 'test.txt'
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:58765
2025-05-02 19:55:00,772 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 58771)
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Sent acknowledgment to server
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Sent file transfer request for 'test.txt'
2025-05-02 19:55:00,772 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,772 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE (RECEIVER)
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 58770)
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-02 19:55:00,772 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 58771)
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  File transfer request for 'test.txt' from shahd22
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Reading file from shared directory
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Read file: 22 bytes
2025-05-02 19:55:00,772 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  GENERATING FILE INTEGRITY HASH
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Generated SHA-256 hash for integrity verification
2025-05-02 19:55:00,772 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  HANDLING DIFFIE-HELLMAN KEY EXCHANGE (SENDER)
2025-05-02 19:55:00,772 - CipherShare Client - INFO -  Waiting for requester's public key...
2025-05-02 19:55:00,789 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-02 19:55:00,789 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-02 19:55:00,789 - CipherShare Client - INFO -  Received requester's public key
2025-05-02 19:55:00,789 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-02 19:55:00,789 - CipherShare Client - INFO -  Initializing our Diffie-Hellman key exchange
2025-05-02 19:55:00,789 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-02 19:55:00,797 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-02 19:55:00,818 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-02 19:55:00,818 - CipherShare Client - INFO -  Sent our public key to requester
2025-05-02 19:55:00,818 - CipherShare Client - INFO -  Received file owner's public key
2025-05-02 19:55:00,818 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-02 19:55:00,818 - CipherShare Client - INFO -  Using peer's public key: 404... (showing last 3 digits)
2025-05-02 19:55:00,818 - CipherShare Client - INFO -  Using peer's public key: 561... (showing last 3 digits)
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  Successfully computed shared encryption key
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  DIFFIE-HELLMAN KEY EXCHANGE COMPLETED
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-02 19:55:00,852 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  RECEIVING FILE INTEGRITY HASH
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  Successfully computed shared encryption key
2025-05-02 19:55:00,852 - CipherShare Client - INFO -  DIFFIE-HELLMAN KEY EXCHANGE COMPLETED
2025-05-02 19:55:00,852 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,860 - CipherShare Client - INFO -  SENDING FILE INTEGRITY HASH
2025-05-02 19:55:00,860 - CipherShare Client - INFO -  Sent file hash for integrity verification
2025-05-02 19:55:00,860 - CipherShare Client - INFO -  Received file integrity hash from sender
2025-05-02 19:55:00,860 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,860 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,860 - CipherShare Client - INFO -  RECEIVING ENCRYPTED FILE
2025-05-02 19:55:00,860 - CipherShare Client - INFO -  Waiting for encrypted file data...
2025-05-02 19:55:00,860 - CipherShare Client - INFO -  ENCRYPTING FILE
2025-05-02 19:55:00,869 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-02 19:55:00,878 - CipherShare Client - INFO -  Original file size: 22 bytes
2025-05-02 19:55:00,878 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-02 19:55:00,878 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 32 bytes)
2025-05-02 19:55:00,902 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-02 19:55:00,902 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 32 bytes)
2025-05-02 19:55:00,955 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,955 - CipherShare Client - INFO -  SENDING ENCRYPTED FILE
2025-05-02 19:55:00,964 - CipherShare Client - INFO -  Sending 48 bytes (IV + encrypted data)
2025-05-02 19:55:00,964 - CipherShare Client - INFO -  File transfer complete
2025-05-02 19:55:00,964 - CipherShare Client - INFO -  Received encrypted file: 48 bytes
2025-05-02 19:55:00,964 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:00,964 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:00,964 - CipherShare Client - INFO -  SECURE FILE TRANSFER COMPLETED SUCCESSFULLY
2025-05-02 19:55:00,964 - CipherShare Client - INFO -  DECRYPTING FILE
==========================================
2025-05-02 19:55:00,972 - CipherShare Client - INFO -  Extracted IV (16 bytes) and ciphertext (32 bytes)
2025-05-02 19:55:00,972 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 58771)
2025-05-02 19:55:00,972 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-02 19:55:00,972 - CipherShare Client - INFO -  Encrypted file size: 32 bytes
2025-05-02 19:55:00,996 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-02 19:55:01,004 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 32 bytes)
2025-05-02 19:55:01,005 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 22 bytes)
2025-05-02 19:55:01,005 - CipherShare Client - INFO -  Successfully decrypted file (size: 22 bytes)
2025-05-02 19:55:01,005 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:01,005 - CipherShare Client - INFO -  VERIFYING FILE INTEGRITY
2025-05-02 19:55:01,005 - CipherShare Client - INFO -  Verifying file integrity with SHA-256 hash
2025-05-02 19:55:01,005 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-02 19:55:01,005 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-02 19:55:01,005 - CipherShare Client - INFO -  INTEGRITY VERIFIED: File hash matches expected value
2025-05-02 19:55:01,005 - CipherShare Client - INFO -  File integrity verified - hash matches!
2025-05-02 19:55:01,013 - CipherShare Client - INFO - --------------------------------------------------
2025-05-02 19:55:01,013 - CipherShare Client - INFO -  SAVING DECRYPTED FILE
2025-05-02 19:55:01,013 - CipherShare Client - INFO -  File saved to downloaded_files\test.txt
2025-05-02 19:55:01,013 - CipherShare Client - INFO - Saved 1 shared files
2025-05-02 19:55:01,013 - CipherShare Client - INFO -  Added file to shared files list
2025-05-02 19:55:01,013 - CipherShare Client - INFO -  Registering file as available from this client
2025-05-02 19:55:01,021 - CipherShare Client - INFO - File 'test.txt' uploaded successfully
2025-05-02 19:55:01,021 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:01,029 - CipherShare Client - INFO -  SECURE FILE DOWNLOAD COMPLETED SUCCESSFULLY
2025-05-02 19:55:01,029 - CipherShare Client - INFO - ============================================================
2025-05-02 19:55:01,029 - CipherShare Client - INFO -  Closed connection to file owner
2025-05-02 19:55:10,655 - CipherShare Client - INFO - Session is valid
2025-05-02 19:55:14,050 - CipherShare Client - INFO - Retrieved 2 available files
2025-05-02 19:55:17,810 - CipherShare Client - INFO - Retrieved 2 available files
2025-05-02 19:55:19,064 - CipherShare Client - INFO - Session is valid
2025-05-02 19:55:21,482 - CipherShare Client - INFO - Session is valid
2025-05-11 08:47:33,145 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-11 08:47:33,152 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 08:47:33,153 - CipherShare Client - INFO - Listening for file transfers on port 51213
2025-05-11 08:47:33,154 - CipherShare Client - INFO - Starting to listen for file transfers on port 51213
2025-05-11 08:49:25,839 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-11 08:49:25,843 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 08:49:25,843 - CipherShare Client - INFO - Listening for file transfers on port 51223
2025-05-11 08:49:25,845 - CipherShare Client - INFO - Starting to listen for file transfers on port 51223
2025-05-11 08:49:43,046 - CipherShare Client - INFO - Registered as donia
2025-05-11 08:50:35,219 - CipherShare Client - INFO - Session is valid
2025-05-11 08:50:42,031 - CipherShare Client - INFO - Disconnected from server
2025-05-11 08:50:47,182 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-11 08:50:47,187 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 08:50:47,187 - CipherShare Client - INFO - Listening for file transfers on port 51326
2025-05-11 08:50:47,188 - CipherShare Client - INFO - Starting to listen for file transfers on port 51326
2025-05-11 08:50:55,526 - CipherShare Client - INFO - Logged in as donia
2025-05-11 08:50:58,911 - CipherShare Client - INFO - Session is valid
2025-05-11 08:52:34,494 - CipherShare Client - INFO - Disconnected from server
2025-05-11 08:52:45,662 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-11 08:52:45,666 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 08:52:45,667 - CipherShare Client - INFO - Listening for file transfers on port 51355
2025-05-11 08:52:45,668 - CipherShare Client - INFO - Starting to listen for file transfers on port 51355
2025-05-11 08:52:53,403 - CipherShare Client - ERROR - Login failed: Invalid username or password
2025-05-11 09:15:43,884 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-11 09:15:43,894 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 09:15:43,894 - CipherShare Client - INFO - Listening for file transfers on port 51552
2025-05-11 09:15:43,895 - CipherShare Client - INFO - Starting to listen for file transfers on port 51552
2025-05-11 09:15:54,333 - CipherShare Client - INFO - Registered as doniaa
2025-05-11 10:13:55,731 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-11 10:13:55,737 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:13:55,738 - CipherShare Client - INFO - Listening for file transfers on port 51755
2025-05-11 10:13:55,738 - CipherShare Client - INFO - Starting to listen for file transfers on port 51755
2025-05-11 10:14:03,339 - CipherShare Client - INFO - Logged in as donia
2025-05-11 10:14:05,461 - CipherShare Client - INFO - Session is valid
2025-05-11 10:14:39,818 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:14:39,981 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 10:14:39,981 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 10:14:39,982 - CipherShare Client - INFO -  Original file size: 0 bytes
2025-05-11 10:14:39,982 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 10:14:39,982 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 10:14:39,982 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 10:14:39,983 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 10:14:39,983 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: 58dc459ecb3ec2536fa14a90ca953c68)
2025-05-11 10:14:40,001 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\newfile.txt
2025-05-11 10:14:40,003 - CipherShare Client - INFO - Saved 2 shared files
2025-05-11 10:14:40,003 - CipherShare Client - INFO - File 'newfile.txt' uploaded successfully
2025-05-11 10:15:51,794 - CipherShare Client - INFO - Session is valid
2025-05-11 10:15:55,913 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:15:58,990 - CipherShare Client - INFO - Session is valid
2025-05-11 10:16:09,076 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:16:09,157 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 10:16:09,162 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 10:16:09,163 - CipherShare Client - INFO -  Original file size: 9 bytes
2025-05-11 10:16:09,163 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 10:16:09,163 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 10:16:09,163 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 10:16:09,164 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 10:16:09,164 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: 9e35a888aab586a1558f6ecbc8268044)
2025-05-11 10:16:09,164 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\newfile.txt
2025-05-11 10:16:09,169 - CipherShare Client - INFO - File 'newfile.txt' uploaded successfully
2025-05-11 10:16:35,858 - CipherShare Client - INFO - Session is valid
2025-05-11 10:16:47,363 - CipherShare Client - INFO - Loaded 2 shared files
2025-05-11 10:16:47,378 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:16:47,379 - CipherShare Client - INFO - Listening for file transfers on port 51764
2025-05-11 10:16:47,381 - CipherShare Client - INFO - Starting to listen for file transfers on port 51764
2025-05-11 10:17:01,476 - CipherShare Client - INFO - Registered as mariamm
2025-05-11 10:17:06,563 - CipherShare Client - INFO - Session is valid
2025-05-11 10:17:09,716 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:17:13,571 - CipherShare Client - INFO - Session is valid
2025-05-11 10:17:16,122 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:17:18,543 - CipherShare Client - INFO - ============================================================
2025-05-11 10:17:18,543 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 10:17:18,545 - CipherShare Client - INFO - ============================================================
2025-05-11 10:17:18,545 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 10:17:18,547 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 51771)
2025-05-11 10:17:18,548 - CipherShare Client - INFO -  Server provided file source: donia at 127.0.0.1:51755
2025-05-11 10:17:18,548 - CipherShare Client - INFO - ============================================================
2025-05-11 10:17:18,548 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-11 10:17:18,548 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 10:17:18,548 - CipherShare Client - INFO - ============================================================
2025-05-11 10:17:18,548 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:51755

2025-05-11 10:17:18,548 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 51772)
2025-05-11 10:17:18,549 - CipherShare Client - INFO -  Sent file transfer request for 'newfile.txt'
2025-05-11 10:17:18,549 - CipherShare Client - INFO -  Received request of type: FILE_INFO
2025-05-11 10:17:18,549 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:17:18,549 - CipherShare Client - INFO -  File info request for upcoming transfer: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 51763, 'requester_username': 'mariamm', 'filename': 'newfile.txt'}
2025-05-11 10:17:18,549 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE (RECEIVER)
2025-05-11 10:17:18,549 - CipherShare Client - INFO - ============================================================
2025-05-11 10:17:18,549 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-11 10:17:18,549 - CipherShare Client - INFO -  Sent acknowledgment
2025-05-11 10:17:18,549 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 10:17:18,549 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 10:17:18,550 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 51771)
2025-05-11 10:17:18,550 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 10:17:18,550 - CipherShare Client - INFO - ============================================================
2025-05-11 10:17:18,550 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 51772)
2025-05-11 10:17:18,550 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-11 10:17:18,551 - CipherShare Client - INFO -  File transfer request for 'newfile.txt' from mariamm
2025-05-11 10:17:18,551 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:17:18,571 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 10:17:18,572 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-11 10:17:18,572 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-11 10:17:18,616 - CipherShare Client - INFO -  Extracted salt, IV, and ciphertext from disk
2025-05-11 10:17:18,626 - CipherShare Client - ERROR -  Transfer error: Invalid padding bytes.
2025-05-11 10:17:18,626 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 51772)
2025-05-11 10:17:18,626 - CipherShare Client - ERROR -  Download error: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-05-11 10:17:18,627 - CipherShare Client - INFO -  Closed connection to file owner
2025-05-11 10:17:28,427 - CipherShare Client - INFO - Session is valid
2025-05-11 10:21:38,101 - CipherShare Client - INFO - Loaded 2 shared files
2025-05-11 10:21:38,106 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:21:38,107 - CipherShare Client - INFO - Listening for file transfers on port 51795
2025-05-11 10:21:38,107 - CipherShare Client - INFO - Starting to listen for file transfers on port 51795
2025-05-11 10:21:45,025 - CipherShare Client - INFO - Logged in as donia
2025-05-11 10:21:49,190 - CipherShare Client - INFO - Session is valid
2025-05-11 10:22:04,678 - CipherShare Client - INFO - Session is valid
2025-05-11 10:22:08,239 - CipherShare Client - INFO - Session is valid
2025-05-11 10:22:09,934 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:22:10,917 - CipherShare Client - INFO - Session is valid
2025-05-11 10:22:45,164 - CipherShare Client - INFO - Session is valid
2025-05-11 10:22:46,806 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:22:48,850 - CipherShare Client - INFO - ============================================================
2025-05-11 10:22:48,851 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 10:22:48,851 - CipherShare Client - INFO - ============================================================
2025-05-11 10:22:48,851 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 10:22:50,920 - CipherShare Client - ERROR -  Download request failed: File "newfile.txt" found but all clients are unreachable
2025-05-11 10:22:54,609 - CipherShare Client - INFO - Session is valid
2025-05-11 10:22:56,593 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 10:22:57,810 - CipherShare Client - INFO - Session is valid
2025-05-11 10:23:23,754 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:23:23,837 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 10:23:23,838 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 10:23:23,838 - CipherShare Client - INFO -  Original file size: 9 bytes
2025-05-11 10:23:23,838 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 10:23:23,838 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 10:23:23,839 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 10:23:23,839 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 10:23:23,839 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: 4af6b37e42ab8066884876cb6312f5e8)
2025-05-11 10:23:23,840 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\newfile1.txt
2025-05-11 10:23:23,842 - CipherShare Client - INFO - Saved 3 shared files
2025-05-11 10:23:23,843 - CipherShare Client - INFO - File 'newfile1.txt' uploaded successfully
2025-05-11 10:23:26,164 - CipherShare Client - INFO - Session is valid
2025-05-11 10:23:32,641 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:23:34,559 - CipherShare Client - INFO - Session is valid
2025-05-11 10:23:38,771 - CipherShare Client - INFO - Session is valid
2025-05-11 10:23:46,429 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:23:46,437 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:23:46,437 - CipherShare Client - INFO - Listening for file transfers on port 51801
2025-05-11 10:23:46,438 - CipherShare Client - INFO - Starting to listen for file transfers on port 51801
2025-05-11 10:23:59,458 - CipherShare Client - INFO - Registered as karim
2025-05-11 10:24:00,819 - CipherShare Client - INFO - Session is valid
2025-05-11 10:24:05,180 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:24:06,699 - CipherShare Client - INFO - Session is valid
2025-05-11 10:24:10,402 - CipherShare Client - INFO - Session is valid
2025-05-11 10:24:16,710 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:24:33,635 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:33,635 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 10:24:33,635 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:33,635 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 10:24:33,637 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 51813)
2025-05-11 10:24:33,637 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:33,637 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 10:24:33,637 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:33,638 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 51813)
2025-05-11 10:24:33,656 - CipherShare Client - INFO -  Received request of type: FILE_INFO
2025-05-11 10:24:33,656 - CipherShare Client - INFO -  File info request for upcoming transfer: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 51800, 'requester_username': 'karim', 'filename': 'newfile1.txt'}
2025-05-11 10:24:33,656 - CipherShare Client - INFO -  Sent acknowledgment
2025-05-11 10:24:33,656 - CipherShare Client - INFO -  Server provided file source: donia at 127.0.0.1:51795
2025-05-11 10:24:33,656 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 51813)
2025-05-11 10:24:33,657 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:24:33,657 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-11 10:24:33,657 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:51795
2025-05-11 10:24:33,657 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 51814)
2025-05-11 10:24:33,657 - CipherShare Client - INFO -  Sent file transfer request for 'newfile1.txt'
2025-05-11 10:24:33,658 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:24:33,658 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:33,658 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-11 10:24:33,658 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 10:24:33,658 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 10:24:33,658 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:33,658 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 51814)
2025-05-11 10:24:33,659 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-11 10:24:33,659 - CipherShare Client - INFO -  File transfer request for 'newfile1.txt' from karim
2025-05-11 10:24:33,659 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:24:33,662 - CipherShare Client - INFO -  Extracted salt, IV, and ciphertext from disk
2025-05-11 10:24:33,662 - CipherShare Client - ERROR -  Transfer error: Invalid padding bytes.
2025-05-11 10:24:33,663 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 51814)
2025-05-11 10:24:33,680 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 10:24:33,680 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-11 10:24:33,680 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-11 10:24:33,682 - CipherShare Client - ERROR -  Download error: [WinError 10053] An established connection was aborted by the software in your host machine
2025-05-11 10:24:33,682 - CipherShare Client - INFO -  Closed connection to file owner
2025-05-11 10:24:38,921 - CipherShare Client - INFO - Session is valid
2025-05-11 10:24:55,924 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:24:58,840 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:58,840 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 10:24:58,840 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:58,841 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 10:24:58,843 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 51815)
2025-05-11 10:24:58,844 - CipherShare Client - INFO -  Server provided file source: donia at 127.0.0.1:51795
2025-05-11 10:24:58,844 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:58,844 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:24:58,844 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 10:24:58,844 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-11 10:24:58,844 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:58,844 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 51815)
2025-05-11 10:24:58,846 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:51795
2025-05-11 10:24:58,846 - CipherShare Client - INFO -  Received request of type: FILE_INFO
2025-05-11 10:24:58,846 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 51816)
2025-05-11 10:24:58,846 - CipherShare Client - INFO -  Sent file transfer request for 'newfile1.txt'
2025-05-11 10:24:58,846 - CipherShare Client - INFO -  File info request for upcoming transfer: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 51800, 'requester_username': 'karim', 'filename': 'newfile1.txt'}
2025-05-11 10:24:58,846 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:24:58,846 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE (RECEIVER)
2025-05-11 10:24:58,847 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:58,847 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-11 10:24:58,847 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 10:24:58,847 - CipherShare Client - INFO -  Sent acknowledgment
2025-05-11 10:24:58,847 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 10:24:58,847 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 10:24:58,847 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 51815)
2025-05-11 10:24:58,847 - CipherShare Client - INFO - ============================================================
2025-05-11 10:24:58,848 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 51816)
2025-05-11 10:24:58,848 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-11 10:24:58,849 - CipherShare Client - INFO -  File transfer request for 'newfile1.txt' from karim
2025-05-11 10:24:58,849 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:24:58,852 - CipherShare Client - INFO -  Extracted salt, IV, and ciphertext from disk
2025-05-11 10:24:58,853 - CipherShare Client - ERROR -  Transfer error: Invalid padding bytes.
2025-05-11 10:24:58,853 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 51816)
2025-05-11 10:24:58,868 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 10:24:58,869 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-11 10:24:58,869 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-11 10:24:58,869 - CipherShare Client - ERROR -  Download error: [WinError 10053] An established connection was aborted by the software in your host machine
2025-05-11 10:24:58,870 - CipherShare Client - INFO -  Closed connection to file owner
2025-05-11 10:31:09,221 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:31:09,226 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:31:09,226 - CipherShare Client - INFO - Listening for file transfers on port 51830
2025-05-11 10:31:09,227 - CipherShare Client - INFO - Starting to listen for file transfers on port 51830
2025-05-11 10:31:17,332 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 10:31:23,899 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:31:23,915 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:31:23,917 - CipherShare Client - INFO - Listening for file transfers on port 51832
2025-05-11 10:31:23,919 - CipherShare Client - INFO - Starting to listen for file transfers on port 51832
2025-05-11 10:31:30,464 - CipherShare Client - ERROR - Login failed: Invalid username or password
2025-05-11 10:31:37,824 - CipherShare Client - INFO - Logged in as donia
2025-05-11 10:31:39,533 - CipherShare Client - INFO - Session is valid
2025-05-11 10:31:47,555 - CipherShare Client - INFO - Session is valid
2025-05-11 10:31:50,779 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:31:52,348 - CipherShare Client - INFO - Session is valid
2025-05-11 10:31:54,937 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:31:56,498 - CipherShare Client - INFO - ============================================================
2025-05-11 10:31:56,498 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 10:31:56,498 - CipherShare Client - INFO - ============================================================
2025-05-11 10:31:56,498 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 10:31:58,551 - CipherShare Client - ERROR -  Download request failed: File "newfile1.txt" found but all clients are unreachable
2025-05-11 10:32:58,496 - CipherShare Client - INFO - Session is valid
2025-05-11 10:33:04,844 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:33:04,850 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 10:37:59,113 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:37:59,118 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:37:59,118 - CipherShare Client - INFO - Listening for file transfers on port 51859
2025-05-11 10:37:59,119 - CipherShare Client - INFO - Starting to listen for file transfers on port 51859
2025-05-11 10:38:03,082 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:38:03,099 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:38:03,100 - CipherShare Client - INFO - Listening for file transfers on port 51861
2025-05-11 10:38:03,103 - CipherShare Client - INFO - Starting to listen for file transfers on port 51861
2025-05-11 10:38:08,715 - CipherShare Client - INFO - Logged in as donia
2025-05-11 10:38:20,544 - CipherShare Client - ERROR - Login failed: Invalid username or password
2025-05-11 10:38:28,911 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 10:38:30,155 - CipherShare Client - INFO - Session is valid
2025-05-11 10:38:32,812 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 10:38:36,411 - CipherShare Client - INFO - Session is valid
2025-05-11 10:38:37,699 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 10:38:38,729 - CipherShare Client - INFO - Session is valid
2025-05-11 10:38:47,904 - CipherShare Client - INFO - Session is valid
2025-05-11 10:39:41,400 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 10:39:44,610 - CipherShare Client - INFO - Session is valid
2025-05-11 10:39:48,102 - CipherShare Client - INFO - Session is valid
2025-05-11 10:40:04,616 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:40:04,622 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:40:04,623 - CipherShare Client - INFO - Listening for file transfers on port 51865
2025-05-11 10:40:04,624 - CipherShare Client - INFO - Starting to listen for file transfers on port 51865
2025-05-11 10:40:09,742 - CipherShare Client - INFO - Logged in as donia
2025-05-11 10:40:15,049 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:40:15,066 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:40:15,067 - CipherShare Client - INFO - Listening for file transfers on port 51867
2025-05-11 10:40:15,069 - CipherShare Client - INFO - Starting to listen for file transfers on port 51867
2025-05-11 10:40:21,912 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 10:40:23,353 - CipherShare Client - INFO - Session is valid
2025-05-11 10:41:22,741 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:41:24,799 - CipherShare Client - ERROR - Failed to connect to server: [WinError 10061] No connection could be made because the target machine actively refused it
2025-05-11 10:41:27,116 - CipherShare Client - ERROR - Failed to connect to server: [WinError 10061] No connection could be made because the target machine actively refused it
2025-05-11 10:42:14,375 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:42:14,381 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:42:14,381 - CipherShare Client - INFO - Listening for file transfers on port 51881
2025-05-11 10:42:14,382 - CipherShare Client - INFO - Starting to listen for file transfers on port 51881
2025-05-11 10:42:21,677 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:42:21,693 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:42:21,694 - CipherShare Client - INFO - Listening for file transfers on port 51885
2025-05-11 10:42:21,696 - CipherShare Client - INFO - Starting to listen for file transfers on port 51885
2025-05-11 10:42:27,403 - CipherShare Client - INFO - Logged in as donia
2025-05-11 10:42:44,637 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 10:42:45,601 - CipherShare Client - INFO - Session is valid
2025-05-11 10:42:48,106 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 10:42:48,662 - CipherShare Client - INFO - Session is valid
2025-05-11 10:42:51,746 - CipherShare Client - INFO - Session is valid
2025-05-11 10:42:53,922 - CipherShare Client - INFO - Session is valid
2025-05-11 10:43:12,916 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:43:12,916 - CipherShare Client - INFO - Encrypting 'testfile.txt' for secure storage (at rest)
2025-05-11 10:43:12,926 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 10:53:58,582 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:53:58,587 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:53:58,588 - CipherShare Client - INFO - Listening for file transfers on port 52064
2025-05-11 10:53:58,589 - CipherShare Client - INFO - Starting to listen for file transfers on port 52064
2025-05-11 10:54:02,413 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 10:54:02,417 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 10:54:02,417 - CipherShare Client - INFO - Listening for file transfers on port 52066
2025-05-11 10:54:02,418 - CipherShare Client - INFO - Starting to listen for file transfers on port 52066
2025-05-11 10:54:10,999 - CipherShare Client - INFO - Logged in as donia
2025-05-11 10:54:18,379 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 10:54:20,340 - CipherShare Client - INFO - Session is valid
2025-05-11 10:54:32,643 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:54:32,643 - CipherShare Client - INFO - Encrypting 'testfile.txt' for secure storage (at rest)
2025-05-11 10:54:32,726 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 10:54:32,727 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 10:54:32,727 - CipherShare Client - INFO -  Original file size: 16 bytes
2025-05-11 10:54:32,728 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 10:54:32,728 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 32 bytes)
2025-05-11 10:54:32,728 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 10:54:32,728 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 32 bytes)
2025-05-11 10:54:32,728 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: 90693f34037b661f159773c297f8230b)
2025-05-11 10:54:32,729 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\testfile.txt
2025-05-11 10:54:32,732 - CipherShare Client - INFO - Saved 4 shared files
2025-05-11 10:54:32,732 - CipherShare Client - INFO - File 'testfile.txt' uploaded successfully
2025-05-11 10:58:01,454 - CipherShare Client - INFO - Session is valid
2025-05-11 10:58:04,734 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:58:22,219 - CipherShare Client - INFO - Session is valid
2025-05-11 10:58:25,880 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 10:58:28,839 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:28,840 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 10:58:28,840 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:28,840 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 10:58:28,843 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 52117)
2025-05-11 10:58:28,843 - CipherShare Client - INFO -  Server provided file source: mariamm at 127.0.0.1:52064
2025-05-11 10:58:28,843 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:28,843 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:28,844 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-11 10:58:28,844 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 10:58:28,844 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:28,844 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 52117)
2025-05-11 10:58:28,844 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:52064
2025-05-11 10:58:28,844 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 52118)
2025-05-11 10:58:28,844 - CipherShare Client - INFO -  Received request of type: FILE_INFO
ile.txt'
2025-05-11 10:58:28,844 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:28,844 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:28,844 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE (RECEIVER)
2025-05-11 10:58:28,844 - CipherShare Client - INFO -  File info request for upcoming transfer: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 52065, 'requester_username': 'donia', 'filename': 'testfile.txt'}
2025-05-11 10:58:28,845 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-11 10:58:28,845 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 10:58:28,845 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 10:58:28,845 - CipherShare Client - INFO -  Sent acknowledgment
2025-05-11 10:58:28,845 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 10:58:28,845 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:28,845 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 52117)
2025-05-11 10:58:28,845 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 52118)
2025-05-11 10:58:28,845 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-11 10:58:28,846 - CipherShare Client - INFO -  File transfer request for 'testfile.txt' from donia
2025-05-11 10:58:28,846 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:28,846 - CipherShare Client - INFO -   Decrypting file from disk (encrypted at rest)
2025-05-11 10:58:28,846 - CipherShare Client - INFO -  Extracted salt, IV, and ciphertext from disk
2025-05-11 10:58:28,865 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 10:58:28,865 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-11 10:58:28,865 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-11 10:58:28,926 - CipherShare Client - INFO -  Derived AES encryption key using PBKDF2 with salt from disk
2025-05-11 10:58:28,926 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 10:58:28,926 - CipherShare Client - INFO -  Encrypted file size: 32 bytes
2025-05-11 10:58:28,927 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 10:58:28,938 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 32 bytes)
2025-05-11 10:58:28,938 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 16 bytes)
2025-05-11 10:58:28,938 - CipherShare Client - INFO -  Successfully decrypted file from disk
2025-05-11 10:58:28,939 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:28,939 - CipherShare Client - INFO -  GENERATING FILE INTEGRITY HASH
2025-05-11 10:58:28,939 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 10:58:28,939 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 10:58:28,939 - CipherShare Client - INFO -  Generated SHA-256 hash
2025-05-11 10:58:28,940 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:28,940 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE
2025-05-11 10:58:28,940 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 10:58:28,940 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 10:58:28,958 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 10:58:28,959 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 10:58:28,959 - CipherShare Client - INFO -  Using peer's public key: 886... (showing last 3 digits)
2025-05-11 10:58:28,983 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 10:58:28,983 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 10:58:28,983 - CipherShare Client - INFO -  Computed shared DH session key
2025-05-11 10:58:28,983 - CipherShare Client - INFO -  Sent our DH public key
2025-05-11 10:58:28,983 - CipherShare Client - INFO -  Received file owner's public key
2025-05-11 10:58:28,984 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:28,984 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 10:58:28,984 - CipherShare Client - INFO -  SENDING FILE HASH
2025-05-11 10:58:28,984 - CipherShare Client - INFO -  Using peer's public key: 833... (showing last 3 digits)
2025-05-11 10:58:28,984 - CipherShare Client - INFO -  Sent file hash
2025-05-11 10:58:28,984 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:28,985 - CipherShare Client - INFO -  Re-encrypting file with DH session key for transit
2025-05-11 10:58:28,985 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 10:58:28,985 - CipherShare Client - INFO -  Original file size: 16 bytes
2025-05-11 10:58:28,985 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 10:58:28,985 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 32 bytes)
2025-05-11 10:58:28,986 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 10:58:28,986 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 32 bytes)
2025-05-11 10:58:28,986 - CipherShare Client - INFO -  Re-encrypted file with DH key (length: 32 bytes)
2025-05-11 10:58:28,986 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:28,986 - CipherShare Client - INFO -  SENDING ENCRYPTED FILE
2025-05-11 10:58:28,986 - CipherShare Client - INFO -  File securely sent
2025-05-11 10:58:28,986 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:28,986 - CipherShare Client - INFO -  SECURE FILE TRANSFER COMPLETE
2025-05-11 10:58:28,986 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:28,987 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 52118)
2025-05-11 10:58:29,007 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 10:58:29,008 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 10:58:29,008 - CipherShare Client - INFO -  Successfully computed shared encryption key
2025-05-11 10:58:29,008 - CipherShare Client - INFO -  DIFFIE-HELLMAN KEY EXCHANGE COMPLETED
2025-05-11 10:58:29,009 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:29,009 - CipherShare Client - INFO -  RECEIVING FILE INTEGRITY HASH
2025-05-11 10:58:29,009 - CipherShare Client - INFO -  Received file integrity hash from sender
2025-05-11 10:58:29,009 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:29,009 - CipherShare Client - INFO -  RECEIVING ENCRYPTED FILE
2025-05-11 10:58:29,010 - CipherShare Client - INFO -  Waiting for encrypted file data...
2025-05-11 10:58:29,010 - CipherShare Client - INFO -  Received encrypted file: 48 bytes
2025-05-11 10:58:29,010 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:29,010 - CipherShare Client - INFO -  DECRYPTING FILE
2025-05-11 10:58:29,010 - CipherShare Client - INFO -  Extracted IV (16 bytes) and ciphertext (32 bytes)
2025-05-11 10:58:29,010 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 10:58:29,011 - CipherShare Client - INFO -  Encrypted file size: 32 bytes
2025-05-11 10:58:29,011 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 10:58:29,012 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 32 bytes)
2025-05-11 10:58:29,012 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 16 bytes)
2025-05-11 10:58:29,012 - CipherShare Client - INFO -  Successfully decrypted file (size: 16 bytes)
2025-05-11 10:58:29,012 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:29,012 - CipherShare Client - INFO -  VERIFYING FILE INTEGRITY
2025-05-11 10:58:29,012 - CipherShare Client - INFO -  Verifying file integrity with SHA-256 hash
2025-05-11 10:58:29,012 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 10:58:29,012 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 10:58:29,022 - CipherShare Client - INFO -  INTEGRITY VERIFIED: File hash matches expected value
2025-05-11 10:58:29,023 - CipherShare Client - INFO -  File integrity verified - hash matches!
2025-05-11 10:58:29,023 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:29,023 - CipherShare Client - INFO -  SAVING DECRYPTED FILE
2025-05-11 10:58:29,023 - CipherShare Client - INFO -  File saved to downloaded_files\testfile.txt
2025-05-11 10:58:29,024 - CipherShare Client - INFO - Saved 4 shared files
2025-05-11 10:58:29,024 - CipherShare Client - INFO -  Added file to shared files list
2025-05-11 10:58:29,025 - CipherShare Client - INFO -  Registering file as available from this client
2025-05-11 10:58:29,025 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 10:58:29,025 - CipherShare Client - INFO - Encrypting 'testfile.txt' for secure storage (at rest)
2025-05-11 10:58:29,026 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 10:58:29,026 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:29,026 - CipherShare Client - INFO -  SECURE FILE DOWNLOAD COMPLETED SUCCESSFULLY
2025-05-11 10:58:29,026 - CipherShare Client - INFO - ============================================================
2025-05-11 10:58:29,026 - CipherShare Client - INFO -  Closed connection to file owner
2025-05-11 11:04:43,429 - CipherShare Client - WARNING - Session is invalid or expired
2025-05-11 11:04:55,062 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 11:04:56,288 - CipherShare Client - INFO - Session is valid
2025-05-11 11:06:46,374 - CipherShare Client - ERROR - Failed to load shared files list: Expecting value: line 1 column 1 (char 0)
2025-05-11 11:06:46,385 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 11:06:46,385 - CipherShare Client - INFO - Listening for file transfers on port 52141
2025-05-11 11:06:46,386 - CipherShare Client - INFO - Starting to listen for file transfers on port 52141
2025-05-11 11:06:49,487 - CipherShare Client - ERROR - Failed to load shared files list: Expecting value: line 1 column 1 (char 0)
2025-05-11 11:06:49,502 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 11:06:49,503 - CipherShare Client - INFO - Listening for file transfers on port 52143
2025-05-11 11:06:49,506 - CipherShare Client - INFO - Starting to listen for file transfers on port 52143
2025-05-11 11:06:58,447 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 11:07:18,630 - CipherShare Client - INFO - Logged in as donia
2025-05-11 11:07:20,843 - CipherShare Client - INFO - Session is valid
2025-05-11 11:07:23,192 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 11:07:26,642 - CipherShare Client - INFO - Session is valid
2025-05-11 11:07:57,951 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:07:57,951 - CipherShare Client - INFO - Encrypting 'newtestfile.txt' for secure storage (at rest)
2025-05-11 11:07:58,037 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 11:07:58,053 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 11:07:58,054 - CipherShare Client - INFO -  Original file size: 26 bytes
2025-05-11 11:07:58,054 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 11:07:58,054 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 32 bytes)
2025-05-11 11:07:58,055 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 11:07:58,055 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 32 bytes)
2025-05-11 11:07:58,055 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: 548ee1fef1f0ce8143912891ce576c68)
2025-05-11 11:07:58,055 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\newtestfile.txt
2025-05-11 11:07:58,057 - CipherShare Client - INFO - Saved 1 shared files
2025-05-11 11:07:58,057 - CipherShare Client - INFO - File 'newtestfile.txt' uploaded successfully
2025-05-11 11:08:06,774 - CipherShare Client - INFO - Session is valid
2025-05-11 11:08:11,858 - CipherShare Client - INFO - Session is valid
2025-05-11 11:08:13,826 - CipherShare Client - INFO - Session is valid
2025-05-11 11:08:17,529 - CipherShare Client - INFO - Session is valid
2025-05-11 11:08:20,267 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 11:08:22,198 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,199 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 11:08:22,199 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,199 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 11:08:22,201 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 52147)
2025-05-11 11:08:22,202 - CipherShare Client - INFO -  Server provided file source: donia at 127.0.0.1:52143
2025-05-11 11:08:22,202 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,202 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,202 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 11:08:22,202 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-11 11:08:22,202 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,202 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 52147)
2025-05-11 11:08:22,202 - CipherShare Client - INFO -  Received request of type: FILE_INFO
2025-05-11 11:08:22,203 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:52143
2025-05-11 11:08:22,203 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 52148)
2025-05-11 11:08:22,203 - CipherShare Client - INFO -  Sent file transfer request for 'newtestfile.txt'
2025-05-11 11:08:22,203 - CipherShare Client - INFO -  File info request for upcoming transfer: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 52140, 'requester_username': 'mariamm', 'filename': 'newtestfile.txt'}
2025-05-11 11:08:22,203 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,203 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE (RECEIVER)
2025-05-11 11:08:22,203 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,203 - CipherShare Client - INFO -  Sent acknowledgment
2025-05-11 11:08:22,203 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-11 11:08:22,203 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 11:08:22,203 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 11:08:22,204 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 52147)
2025-05-11 11:08:22,204 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 11:08:22,204 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,204 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 52148)
2025-05-11 11:08:22,204 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-11 11:08:22,204 - CipherShare Client - INFO -  File transfer request for 'newtestfile.txt' from mariamm
2025-05-11 11:08:22,204 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,205 - CipherShare Client - INFO -   Decrypting file from disk (encrypted at rest)
2025-05-11 11:08:22,221 - CipherShare Client - INFO -  Extracted salt, IV, and ciphertext from disk
2025-05-11 11:08:22,224 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 11:08:22,224 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-11 11:08:22,224 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-11 11:08:22,299 - CipherShare Client - INFO -  Derived AES encryption key using PBKDF2 with salt from disk
2025-05-11 11:08:22,299 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 11:08:22,299 - CipherShare Client - INFO -  Encrypted file size: 32 bytes
2025-05-11 11:08:22,300 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 11:08:22,300 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 32 bytes)
2025-05-11 11:08:22,300 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 26 bytes)
2025-05-11 11:08:22,300 - CipherShare Client - INFO -  Successfully decrypted file from disk
2025-05-11 11:08:22,300 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,300 - CipherShare Client - INFO -  GENERATING FILE INTEGRITY HASH
2025-05-11 11:08:22,301 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 11:08:22,301 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 11:08:22,301 - CipherShare Client - INFO -  Generated SHA-256 hash
2025-05-11 11:08:22,301 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,301 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE
2025-05-11 11:08:22,302 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 11:08:22,302 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 11:08:22,320 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 11:08:22,321 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 11:08:22,321 - CipherShare Client - INFO -  Using peer's public key: 953... (showing last 3 digits)
2025-05-11 11:08:22,342 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 11:08:22,343 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 11:08:22,344 - CipherShare Client - INFO -  Computed shared DH session key
2025-05-11 11:08:22,344 - CipherShare Client - INFO -  Sent our DH public key
2025-05-11 11:08:22,344 - CipherShare Client - INFO -  Received file owner's public key
2025-05-11 11:08:22,344 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,344 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 11:08:22,344 - CipherShare Client - INFO -  SENDING FILE HASH
2025-05-11 11:08:22,344 - CipherShare Client - INFO -  Using peer's public key: 842... (showing last 3 digits)
2025-05-11 11:08:22,345 - CipherShare Client - INFO -  Sent file hash
2025-05-11 11:08:22,345 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,345 - CipherShare Client - INFO -  Re-encrypting file with DH session key for transit
2025-05-11 11:08:22,345 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 11:08:22,345 - CipherShare Client - INFO -  Original file size: 26 bytes
2025-05-11 11:08:22,346 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 11:08:22,346 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 32 bytes)
2025-05-11 11:08:22,346 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 11:08:22,346 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 32 bytes)
2025-05-11 11:08:22,346 - CipherShare Client - INFO -  Re-encrypted file with DH key (length: 32 bytes)
2025-05-11 11:08:22,347 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,347 - CipherShare Client - INFO -  SENDING ENCRYPTED FILE
2025-05-11 11:08:22,347 - CipherShare Client - INFO -  File securely sent
2025-05-11 11:08:22,347 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,347 - CipherShare Client - INFO -  SECURE FILE TRANSFER COMPLETE
2025-05-11 11:08:22,347 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,347 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 52148)
2025-05-11 11:08:22,372 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 11:08:22,372 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 11:08:22,372 - CipherShare Client - INFO -  Successfully computed shared encryption key
2025-05-11 11:08:22,372 - CipherShare Client - INFO -  DIFFIE-HELLMAN KEY EXCHANGE COMPLETED
2025-05-11 11:08:22,373 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,373 - CipherShare Client - INFO -  RECEIVING FILE INTEGRITY HASH
2025-05-11 11:08:22,373 - CipherShare Client - INFO -  Received file integrity hash from sender
2025-05-11 11:08:22,373 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,373 - CipherShare Client - INFO -  RECEIVING ENCRYPTED FILE
2025-05-11 11:08:22,374 - CipherShare Client - INFO -  Waiting for encrypted file data...
2025-05-11 11:08:22,374 - CipherShare Client - INFO -  Received encrypted file: 48 bytes
2025-05-11 11:08:22,374 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,374 - CipherShare Client - INFO -  DECRYPTING FILE
2025-05-11 11:08:22,374 - CipherShare Client - INFO -  Extracted IV (16 bytes) and ciphertext (32 bytes)
2025-05-11 11:08:22,375 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 11:08:22,375 - CipherShare Client - INFO -  Encrypted file size: 32 bytes
2025-05-11 11:08:22,375 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 11:08:22,375 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 32 bytes)
2025-05-11 11:08:22,376 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 26 bytes)
2025-05-11 11:08:22,376 - CipherShare Client - INFO -  Successfully decrypted file (size: 26 bytes)
2025-05-11 11:08:22,376 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,376 - CipherShare Client - INFO -  VERIFYING FILE INTEGRITY
2025-05-11 11:08:22,377 - CipherShare Client - INFO -  Verifying file integrity with SHA-256 hash
2025-05-11 11:08:22,377 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 11:08:22,377 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 11:08:22,377 - CipherShare Client - INFO -  INTEGRITY VERIFIED: File hash matches expected value
2025-05-11 11:08:22,377 - CipherShare Client - INFO -  File integrity verified - hash matches!
2025-05-11 11:08:22,378 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,378 - CipherShare Client - INFO -  SAVING DECRYPTED FILE
2025-05-11 11:08:22,425 - CipherShare Client - INFO -  File saved to downloaded_files\newtestfile.txt
2025-05-11 11:08:22,426 - CipherShare Client - INFO - Saved 1 shared files
2025-05-11 11:08:22,426 - CipherShare Client - INFO -  Added file to shared files list
2025-05-11 11:08:22,426 - CipherShare Client - INFO -  Registering file as available from this client
2025-05-11 11:08:22,426 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:08:22,426 - CipherShare Client - INFO - Encrypting 'newtestfile.txt' for secure storage (at rest)
2025-05-11 11:08:22,427 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 11:08:22,427 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,427 - CipherShare Client - INFO -  SECURE FILE DOWNLOAD COMPLETED SUCCESSFULLY
2025-05-11 11:08:22,427 - CipherShare Client - INFO - ============================================================
2025-05-11 11:08:22,428 - CipherShare Client - INFO -  Closed connection to file owner
2025-05-11 11:08:58,627 - CipherShare Client - INFO - Session is valid
2025-05-11 11:09:37,812 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:37,812 - CipherShare Client - INFO - Encrypting 'testfile2.txt' for secure storage (at rest)
2025-05-11 11:09:37,889 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 11:09:37,890 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 11:09:37,890 - CipherShare Client - INFO -  Original file size: 0 bytes
2025-05-11 11:09:37,890 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 11:09:37,891 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 11:09:37,891 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 11:09:37,891 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 11:09:37,891 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: cb7ed26d2717480308550c269e6fc5ba)
2025-05-11 11:09:37,892 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\testfile2.txt
2025-05-11 11:09:37,894 - CipherShare Client - INFO - Saved 2 shared files
2025-05-11 11:09:37,895 - CipherShare Client - INFO - File 'testfile2.txt' uploaded successfully
2025-05-11 11:09:41,359 - CipherShare Client - INFO - Session is valid
2025-05-11 11:09:46,387 - CipherShare Client - INFO - Retrieved 2 available files
2025-05-11 11:09:48,968 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:48,969 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 11:09:48,969 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:48,969 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 11:09:48,971 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 52150)
2025-05-11 11:09:48,972 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:48,973 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 11:09:48,973 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:48,973 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 52150)
2025-05-11 11:09:48,993 - CipherShare Client - INFO -  Received request of type: FILE_INFO
2025-05-11 11:09:48,993 - CipherShare Client - INFO -  File info request for upcoming transfer: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 52140, 'requester_username': 'mariamm', 'filename': 'testfile2.txt'}
2025-05-11 11:09:48,993 - CipherShare Client - INFO -  Server provided file source: donia at 127.0.0.1:52143
2025-05-11 11:09:48,993 - CipherShare Client - INFO -  Sent acknowledgment
2025-05-11 11:09:48,994 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 52150)
2025-05-11 11:09:48,994 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:48,994 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-11 11:09:48,994 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 52151)
2025-05-11 11:09:48,995 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:48,995 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 11:09:48,995 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:48,995 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 52151)
2025-05-11 11:09:49,007 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:52143
2025-05-11 11:09:49,007 - CipherShare Client - INFO -  Sent file transfer request for 'testfile2.txt'
2025-05-11 11:09:49,007 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-11 11:09:49,008 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,008 - CipherShare Client - INFO -  File transfer request for 'testfile2.txt' from mariamm
2025-05-11 11:09:49,008 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE (RECEIVER)
2025-05-11 11:09:49,008 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-11 11:09:49,008 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,008 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 11:09:49,008 - CipherShare Client - INFO -   Decrypting file from disk (encrypted at rest)
2025-05-11 11:09:49,008 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 11:09:49,028 - CipherShare Client - INFO -  Extracted salt, IV, and ciphertext from disk
2025-05-11 11:09:49,029 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 11:09:49,029 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-11 11:09:49,029 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-11 11:09:49,111 - CipherShare Client - INFO -  Derived AES encryption key using PBKDF2 with salt from disk
2025-05-11 11:09:49,112 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 11:09:49,112 - CipherShare Client - INFO -  Encrypted file size: 16 bytes
2025-05-11 11:09:49,112 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 11:09:49,112 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 16 bytes)
2025-05-11 11:09:49,113 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 0 bytes)
2025-05-11 11:09:49,113 - CipherShare Client - INFO -  Successfully decrypted file from disk
2025-05-11 11:09:49,113 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,113 - CipherShare Client - INFO -  GENERATING FILE INTEGRITY HASH
2025-05-11 11:09:49,113 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 11:09:49,113 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 11:09:49,113 - CipherShare Client - INFO -  Generated SHA-256 hash
2025-05-11 11:09:49,114 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,114 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE
2025-05-11 11:09:49,114 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 11:09:49,114 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 11:09:49,132 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 11:09:49,134 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 11:09:49,134 - CipherShare Client - INFO -  Using peer's public key: 675... (showing last 3 digits)
2025-05-11 11:09:49,156 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 11:09:49,156 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 11:09:49,156 - CipherShare Client - INFO -  Computed shared DH session key
2025-05-11 11:09:49,157 - CipherShare Client - INFO -  Sent our DH public key
2025-05-11 11:09:49,157 - CipherShare Client - INFO -  Received file owner's public key
2025-05-11 11:09:49,157 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,157 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 11:09:49,157 - CipherShare Client - INFO -  SENDING FILE HASH
2025-05-11 11:09:49,157 - CipherShare Client - INFO -  Using peer's public key: 635... (showing last 3 digits)
2025-05-11 11:09:49,157 - CipherShare Client - INFO -  Sent file hash
2025-05-11 11:09:49,158 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,158 - CipherShare Client - INFO -  Re-encrypting file with DH session key for transit
2025-05-11 11:09:49,158 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 11:09:49,158 - CipherShare Client - INFO -  Original file size: 0 bytes
2025-05-11 11:09:49,158 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 11:09:49,159 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 11:09:49,159 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 11:09:49,159 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 11:09:49,160 - CipherShare Client - INFO -  Re-encrypted file with DH key (length: 16 bytes)
2025-05-11 11:09:49,160 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,160 - CipherShare Client - INFO -  SENDING ENCRYPTED FILE
2025-05-11 11:09:49,160 - CipherShare Client - INFO -  File securely sent
2025-05-11 11:09:49,160 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:49,161 - CipherShare Client - INFO -  SECURE FILE TRANSFER COMPLETE
2025-05-11 11:09:49,161 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:49,161 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 52151)
2025-05-11 11:09:49,182 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 11:09:49,182 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 11:09:49,182 - CipherShare Client - INFO -  Successfully computed shared encryption key
2025-05-11 11:09:49,182 - CipherShare Client - INFO -  DIFFIE-HELLMAN KEY EXCHANGE COMPLETED
2025-05-11 11:09:49,183 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,183 - CipherShare Client - INFO -  RECEIVING FILE INTEGRITY HASH
2025-05-11 11:09:49,183 - CipherShare Client - INFO -  Received file integrity hash from sender
2025-05-11 11:09:49,184 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,184 - CipherShare Client - INFO -  RECEIVING ENCRYPTED FILE
2025-05-11 11:09:49,184 - CipherShare Client - INFO -  Waiting for encrypted file data...
2025-05-11 11:09:49,184 - CipherShare Client - INFO -  Received encrypted file: 32 bytes
2025-05-11 11:09:49,184 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,184 - CipherShare Client - INFO -  DECRYPTING FILE
2025-05-11 11:09:49,185 - CipherShare Client - INFO -  Extracted IV (16 bytes) and ciphertext (16 bytes)
2025-05-11 11:09:49,185 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 11:09:49,185 - CipherShare Client - INFO -  Encrypted file size: 16 bytes
2025-05-11 11:09:49,185 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 11:09:49,185 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 16 bytes)
2025-05-11 11:09:49,186 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 0 bytes)
2025-05-11 11:09:49,186 - CipherShare Client - INFO -  Successfully decrypted file (size: 0 bytes)
2025-05-11 11:09:49,186 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,186 - CipherShare Client - INFO -  VERIFYING FILE INTEGRITY
2025-05-11 11:09:49,186 - CipherShare Client - INFO -  Verifying file integrity with SHA-256 hash
2025-05-11 11:09:49,186 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 11:09:49,186 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 11:09:49,187 - CipherShare Client - INFO -  INTEGRITY VERIFIED: File hash matches expected value
2025-05-11 11:09:49,187 - CipherShare Client - INFO -  File integrity verified - hash matches!
2025-05-11 11:09:49,187 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,187 - CipherShare Client - INFO -  SAVING DECRYPTED FILE
2025-05-11 11:09:49,187 - CipherShare Client - INFO -  File saved to downloaded_files\testfile2.txt
2025-05-11 11:09:49,188 - CipherShare Client - INFO - Saved 2 shared files
2025-05-11 11:09:49,188 - CipherShare Client - INFO -  Added file to shared files list
2025-05-11 11:09:49,188 - CipherShare Client - INFO -  Registering file as available from this client
2025-05-11 11:09:49,188 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:09:49,188 - CipherShare Client - INFO - Encrypting 'testfile2.txt' for secure storage (at rest)
2025-05-11 11:09:49,188 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 11:09:49,188 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:49,190 - CipherShare Client - INFO -  SECURE FILE DOWNLOAD COMPLETED SUCCESSFULLY
2025-05-11 11:09:49,190 - CipherShare Client - INFO - ============================================================
2025-05-11 11:09:49,190 - CipherShare Client - INFO -  Closed connection to file owner
2025-05-11 11:09:54,397 - CipherShare Client - INFO - Session is valid
2025-05-11 11:10:01,266 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:10:01,267 - CipherShare Client - INFO - Encrypting 'testfile2.txt' for secure storage (at rest)
2025-05-11 11:10:01,267 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 11:10:07,949 - CipherShare Client - INFO - Session is valid
2025-05-11 11:10:33,404 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 11:10:33,404 - CipherShare Client - INFO - Encrypting 'test3.txt' for secure storage (at rest)
2025-05-11 11:10:33,404 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 13:24:51,567 - CipherShare Client - INFO - Loaded 2 shared files
2025-05-11 13:24:51,572 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 13:24:51,573 - CipherShare Client - INFO - Listening for file transfers on port 53119
2025-05-11 13:24:51,573 - CipherShare Client - INFO - Starting to listen for file transfers on port 53119
2025-05-11 13:25:30,382 - CipherShare Client - INFO - Logged in as donia
2025-05-11 13:25:36,023 - CipherShare Client - INFO - Loaded 2 shared files
2025-05-11 13:25:36,028 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 13:25:36,028 - CipherShare Client - INFO - Listening for file transfers on port 53123
2025-05-11 13:25:36,029 - CipherShare Client - INFO - Starting to listen for file transfers on port 53123
2025-05-11 13:25:45,258 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 13:25:46,892 - CipherShare Client - INFO - Session is valid
2025-05-11 13:26:39,373 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:26:39,374 - CipherShare Client - INFO - Encrypting 'test66.txt' for secure storage (at rest)
2025-05-11 13:26:39,449 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 13:26:39,455 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 13:26:39,455 - CipherShare Client - INFO -  Original file size: 12 bytes
2025-05-11 13:26:39,455 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 13:26:39,456 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 13:26:39,456 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 13:26:39,456 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 13:26:39,456 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: 3b41dc3b123afc6ba689a67a1b169f5a)
2025-05-11 13:26:39,457 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\test66.txt
2025-05-11 13:26:39,460 - CipherShare Client - INFO - Saved 3 shared files
2025-05-11 13:26:39,460 - CipherShare Client - INFO - File 'test66.txt' uploaded successfully
2025-05-11 13:26:41,949 - CipherShare Client - INFO - Session is valid
2025-05-11 13:26:53,478 - CipherShare Client - INFO - Session is valid
2025-05-11 13:26:57,201 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 13:26:59,101 - CipherShare Client - INFO - ============================================================
2025-05-11 13:26:59,101 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 13:26:59,101 - CipherShare Client - INFO - ============================================================
2025-05-11 13:26:59,102 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 13:26:59,103 - CipherShare Client - ERROR -  Download request failed: File "test66.txt" not found or no online clients have it
2025-05-11 13:27:13,899 - CipherShare Client - INFO - Session is valid
2025-05-11 13:27:18,862 - CipherShare Client - INFO - Disconnected from server
2025-05-11 13:27:22,411 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 13:27:22,415 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 13:27:22,415 - CipherShare Client - INFO - Listening for file transfers on port 53135
2025-05-11 13:27:22,416 - CipherShare Client - INFO - Starting to listen for file transfers on port 53135
2025-05-11 13:27:29,718 - CipherShare Client - INFO - Logged in as donia
2025-05-11 13:27:30,669 - CipherShare Client - INFO - Session is valid
2025-05-11 13:27:32,436 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 13:27:34,769 - CipherShare Client - INFO - Session is valid
2025-05-11 13:27:36,054 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 13:27:37,738 - CipherShare Client - INFO - Session is valid
2025-05-11 13:27:48,548 - CipherShare Client - INFO - Session is valid
2025-05-11 13:27:50,306 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 13:27:51,615 - CipherShare Client - INFO - Session is valid
2025-05-11 13:28:06,800 - CipherShare Client - INFO - Disconnected from server
2025-05-11 13:28:09,433 - CipherShare Client - INFO - Loaded 3 shared files
2025-05-11 13:28:09,450 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 13:28:09,450 - CipherShare Client - INFO - Listening for file transfers on port 53140
2025-05-11 13:28:09,452 - CipherShare Client - INFO - Starting to listen for file transfers on port 53140
2025-05-11 13:28:14,619 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 13:28:15,221 - CipherShare Client - INFO - Session is valid
2025-05-11 13:28:17,200 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 13:28:18,560 - CipherShare Client - INFO - Session is valid
2025-05-11 13:28:35,131 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:28:35,131 - CipherShare Client - INFO - Encrypting 'test66.txt' for secure storage (at rest)
2025-05-11 13:28:35,132 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 13:28:39,281 - CipherShare Client - INFO - Session is valid
2025-05-11 13:29:10,773 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:29:10,773 - CipherShare Client - INFO - Encrypting 'test45.txt' for secure storage (at rest)
2025-05-11 13:29:10,773 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 13:29:13,283 - CipherShare Client - INFO - Session is valid
2025-05-11 13:30:05,036 - CipherShare Client - ERROR - Failed to load shared files list: Expecting value: line 1 column 1 (char 0)
2025-05-11 13:30:05,041 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 13:30:05,041 - CipherShare Client - INFO - Listening for file transfers on port 53145
2025-05-11 13:30:05,042 - CipherShare Client - INFO - Starting to listen for file transfers on port 53145
2025-05-11 13:30:10,202 - CipherShare Client - INFO - Logged in as donia
2025-05-11 13:30:12,248 - CipherShare Client - INFO - Session is valid
2025-05-11 13:30:19,994 - CipherShare Client - ERROR - Failed to load shared files list: Expecting value: line 1 column 1 (char 0)
2025-05-11 13:30:19,999 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 13:30:19,999 - CipherShare Client - INFO - Listening for file transfers on port 53147
2025-05-11 13:30:20,000 - CipherShare Client - INFO - Starting to listen for file transfers on port 53147
2025-05-11 13:30:25,362 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 13:30:26,016 - CipherShare Client - INFO - Session is valid
2025-05-11 13:30:27,931 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 13:30:28,643 - CipherShare Client - INFO - Session is valid
2025-05-11 13:30:41,368 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:30:41,368 - CipherShare Client - INFO - Encrypting 'test45.txt' for secure storage (at rest)
2025-05-11 13:30:41,368 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 13:30:43,949 - CipherShare Client - INFO - Session is valid
2025-05-11 13:31:20,152 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:31:20,152 - CipherShare Client - INFO - Encrypting 'test1.txt' for secure storage (at rest)
2025-05-11 13:31:20,152 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 13:34:32,900 - CipherShare Client - ERROR - Failed to load shared files list: Expecting value: line 1 column 1 (char 0)
2025-05-11 13:34:32,906 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 13:34:32,906 - CipherShare Client - INFO - Listening for file transfers on port 53165
2025-05-11 13:34:32,907 - CipherShare Client - INFO - Starting to listen for file transfers on port 53165
2025-05-11 13:34:43,410 - CipherShare Client - INFO - Logged in as donia
2025-05-11 13:34:52,505 - CipherShare Client - ERROR - Failed to load shared files list: Expecting value: line 1 column 1 (char 0)
2025-05-11 13:34:52,516 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 13:34:52,516 - CipherShare Client - INFO - Listening for file transfers on port 53169
2025-05-11 13:34:52,517 - CipherShare Client - INFO - Starting to listen for file transfers on port 53169
2025-05-11 13:34:59,235 - CipherShare Client - INFO - Logged in as mariamm
2025-05-11 13:34:59,831 - CipherShare Client - INFO - Session is valid
2025-05-11 13:35:04,204 - CipherShare Client - INFO - Session is valid
2025-05-11 13:35:06,065 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 13:35:07,241 - CipherShare Client - INFO - Session is valid
2025-05-11 13:35:30,315 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:35:30,315 - CipherShare Client - INFO - Encrypting 'test1.txt' for secure storage (at rest)
2025-05-11 13:35:30,391 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 13:35:30,397 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 13:35:30,398 - CipherShare Client - INFO -  Original file size: 10 bytes
2025-05-11 13:35:30,398 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 13:35:30,398 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 13:35:30,398 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 13:35:30,398 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 13:35:30,399 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: 65d9fcc352d02e39bfe2e4a05ce7e078)
2025-05-11 13:35:30,680 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\test1.txt
2025-05-11 13:35:30,687 - CipherShare Client - INFO - Saved 1 shared files
2025-05-11 13:35:30,688 - CipherShare Client - INFO - File 'test1.txt' uploaded successfully
2025-05-11 13:35:45,108 - CipherShare Client - INFO - Session is valid
2025-05-11 13:35:52,240 - CipherShare Client - INFO - Session is valid
2025-05-11 13:35:53,869 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 13:36:25,001 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,002 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 13:36:25,002 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,002 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 13:36:25,004 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 53197)
2025-05-11 13:36:25,004 - CipherShare Client - INFO -  Server provided file source: mariamm at 127.0.0.1:53169
2025-05-11 13:36:25,005 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,005 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,005 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-11 13:36:25,005 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 13:36:25,005 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,005 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 53197)
2025-05-11 13:36:25,005 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:53169
2025-05-11 13:36:25,005 - CipherShare Client - INFO -  Received request of type: FILE_INFO
2025-05-11 13:36:25,005 - CipherShare Client - INFO -  Sent file transfer request for 'test1.txt'

2025-05-11 13:36:25,005 - CipherShare Client - INFO -  File info request for upcoming transfer: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 53164, 'requester_username': 'donia', 'filename': 'test1.txt'}
2025-05-11 13:36:25,005 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,006 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE (RECEIVER)
2025-05-11 13:36:25,006 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,006 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-11 13:36:25,006 - CipherShare Client - INFO -  Sent acknowledgment
2025-05-11 13:36:25,006 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 13:36:25,006 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 13:36:25,006 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 13:36:25,006 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 53197)
2025-05-11 13:36:25,006 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,007 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 53198)
2025-05-11 13:36:25,007 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-11 13:36:25,007 - CipherShare Client - INFO -  File transfer request for 'test1.txt' from donia
2025-05-11 13:36:25,007 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,008 - CipherShare Client - INFO -   Decrypting file from disk (encrypted at rest)
2025-05-11 13:36:25,008 - CipherShare Client - INFO -  Extracted salt, IV, and ciphertext from disk
2025-05-11 13:36:25,025 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 13:36:25,025 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-11 13:36:25,026 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-11 13:36:25,083 - CipherShare Client - INFO -  Derived AES encryption key using PBKDF2 with salt from disk
2025-05-11 13:36:25,083 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 13:36:25,083 - CipherShare Client - INFO -  Encrypted file size: 16 bytes
2025-05-11 13:36:25,084 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 13:36:25,084 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 16 bytes)
2025-05-11 13:36:25,084 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 10 bytes)
2025-05-11 13:36:25,084 - CipherShare Client - INFO -  Successfully decrypted file from disk
2025-05-11 13:36:25,084 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,085 - CipherShare Client - INFO -  GENERATING FILE INTEGRITY HASH
2025-05-11 13:36:25,085 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 13:36:25,085 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 13:36:25,086 - CipherShare Client - INFO -  Generated SHA-256 hash
2025-05-11 13:36:25,086 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,086 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE
2025-05-11 13:36:25,086 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 13:36:25,086 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 13:36:25,105 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 13:36:25,105 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 13:36:25,105 - CipherShare Client - INFO -  Using peer's public key: 221... (showing last 3 digits)
2025-05-11 13:36:25,127 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 13:36:25,127 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 13:36:25,127 - CipherShare Client - INFO -  Computed shared DH session key
2025-05-11 13:36:25,128 - CipherShare Client - INFO -  Sent our DH public key
2025-05-11 13:36:25,128 - CipherShare Client - INFO -  Received file owner's public key
2025-05-11 13:36:25,128 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,128 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 13:36:25,128 - CipherShare Client - INFO -  SENDING FILE HASH
2025-05-11 13:36:25,128 - CipherShare Client - INFO -  Using peer's public key: 764... (showing last 3 digits)
2025-05-11 13:36:25,128 - CipherShare Client - INFO -  Sent file hash
2025-05-11 13:36:25,129 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,129 - CipherShare Client - INFO -  Re-encrypting file with DH session key for transit
2025-05-11 13:36:25,129 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 13:36:25,130 - CipherShare Client - INFO -  Original file size: 10 bytes
2025-05-11 13:36:25,130 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 13:36:25,130 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 13:36:25,130 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 13:36:25,131 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 13:36:25,131 - CipherShare Client - INFO -  Re-encrypted file with DH key (length: 16 bytes)
2025-05-11 13:36:25,131 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,131 - CipherShare Client - INFO -  SENDING ENCRYPTED FILE
2025-05-11 13:36:25,131 - CipherShare Client - INFO -  File securely sent
2025-05-11 13:36:25,132 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,132 - CipherShare Client - INFO -  SECURE FILE TRANSFER COMPLETE
2025-05-11 13:36:25,132 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,132 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 53198)
2025-05-11 13:36:25,151 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 13:36:25,151 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 13:36:25,151 - CipherShare Client - INFO -  Successfully computed shared encryption key
2025-05-11 13:36:25,151 - CipherShare Client - INFO -  DIFFIE-HELLMAN KEY EXCHANGE COMPLETED
2025-05-11 13:36:25,151 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,152 - CipherShare Client - INFO -  RECEIVING FILE INTEGRITY HASH
2025-05-11 13:36:25,152 - CipherShare Client - INFO -  Received file integrity hash from sender
2025-05-11 13:36:25,152 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,152 - CipherShare Client - INFO -  RECEIVING ENCRYPTED FILE
2025-05-11 13:36:25,152 - CipherShare Client - INFO -  Waiting for encrypted file data...
2025-05-11 13:36:25,153 - CipherShare Client - INFO -  Received encrypted file: 32 bytes
2025-05-11 13:36:25,153 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,153 - CipherShare Client - INFO -  DECRYPTING FILE
2025-05-11 13:36:25,153 - CipherShare Client - INFO -  Extracted IV (16 bytes) and ciphertext (16 bytes)
2025-05-11 13:36:25,154 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 13:36:25,154 - CipherShare Client - INFO -  Encrypted file size: 16 bytes
2025-05-11 13:36:25,154 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 13:36:25,154 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 16 bytes)
2025-05-11 13:36:25,154 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 10 bytes)
2025-05-11 13:36:25,155 - CipherShare Client - INFO -  Successfully decrypted file (size: 10 bytes)
2025-05-11 13:36:25,155 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,155 - CipherShare Client - INFO -  VERIFYING FILE INTEGRITY
2025-05-11 13:36:25,155 - CipherShare Client - INFO -  Verifying file integrity with SHA-256 hash
2025-05-11 13:36:25,155 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 13:36:25,155 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 13:36:25,155 - CipherShare Client - INFO -  INTEGRITY VERIFIED: File hash matches expected value
2025-05-11 13:36:25,156 - CipherShare Client - INFO -  File integrity verified - hash matches!
2025-05-11 13:36:25,156 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,156 - CipherShare Client - INFO -  SAVING DECRYPTED FILE
2025-05-11 13:36:25,203 - CipherShare Client - INFO -  File saved to downloaded_files\test1.txt
2025-05-11 13:36:25,205 - CipherShare Client - INFO - Saved 1 shared files
2025-05-11 13:36:25,205 - CipherShare Client - INFO -  Added file to shared files list
2025-05-11 13:36:25,206 - CipherShare Client - INFO -  Registering file as available from this client
2025-05-11 13:36:25,207 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 13:36:25,208 - CipherShare Client - INFO - Encrypting 'test1.txt' for secure storage (at rest)
2025-05-11 13:36:25,210 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 13:36:25,211 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,211 - CipherShare Client - INFO -  SECURE FILE DOWNLOAD COMPLETED SUCCESSFULLY
2025-05-11 13:36:25,212 - CipherShare Client - INFO - ============================================================
2025-05-11 13:36:25,213 - CipherShare Client - INFO -  Closed connection to file owner
2025-05-11 14:13:40,980 - CipherShare Client - WARNING - Session is invalid or expired
2025-05-11 14:13:48,828 - CipherShare Client - INFO - Registered as habiba
2025-05-11 15:34:03,499 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-11 15:34:05,560 - CipherShare Client - ERROR - Failed to connect to server: [WinError 10061] No connection could be made because the target machine actively refused it
2025-05-11 15:34:07,631 - CipherShare Client - ERROR - Failed to connect to server: [WinError 10061] No connection could be made because the target machine actively refused it
2025-05-11 15:34:21,595 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-11 15:34:21,614 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 15:34:21,615 - CipherShare Client - INFO - Listening for file transfers on port 54481
2025-05-11 15:34:21,616 - CipherShare Client - INFO - Starting to listen for file transfers on port 54481
2025-05-11 15:34:50,602 - CipherShare Client - ERROR - Login failed: Invalid username or password
2025-05-11 15:35:04,561 - CipherShare Client - ERROR - Registration failed: Username already exists or registration failed
2025-05-11 15:35:17,185 - CipherShare Client - INFO - Registered as mariaam
2025-05-11 15:35:19,006 - CipherShare Client - INFO - Session is valid
2025-05-11 15:35:27,117 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-11 15:35:27,122 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 15:35:27,122 - CipherShare Client - INFO - Listening for file transfers on port 54487
2025-05-11 15:35:27,123 - CipherShare Client - INFO - Starting to listen for file transfers on port 54487
2025-05-11 15:35:37,338 - CipherShare Client - ERROR - Registration failed: Username already exists or registration failed
2025-05-11 15:35:46,499 - CipherShare Client - INFO - Registered as doniia
2025-05-11 15:35:47,859 - CipherShare Client - INFO - Session is valid
2025-05-11 15:37:38,033 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 15:37:38,033 - CipherShare Client - INFO - Encrypting 'test1.txt' for secure storage (at rest)
2025-05-11 15:37:38,033 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 15:37:40,257 - CipherShare Client - INFO - Session is valid
2025-05-11 15:37:43,139 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 15:39:10,346 - CipherShare Client - INFO - Session is valid
2025-05-11 15:39:17,435 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 15:39:17,435 - CipherShare Client - INFO - Encrypting 'test1.txt' for secure storage (at rest)
2025-05-11 15:39:17,436 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 15:39:31,232 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 16:22:43,687 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-11 16:22:43,704 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 16:22:43,704 - CipherShare Client - INFO - Listening for file transfers on port 55225
2025-05-11 16:22:43,706 - CipherShare Client - INFO - Starting to listen for file transfers on port 55225
2025-05-11 16:22:47,082 - CipherShare Client - INFO - Loaded 0 shared files
2025-05-11 16:22:47,088 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 16:22:47,088 - CipherShare Client - INFO - Listening for file transfers on port 55227
2025-05-11 16:22:47,089 - CipherShare Client - INFO - Starting to listen for file transfers on port 55227
2025-05-11 16:23:00,125 - CipherShare Client - INFO - Registered as lamy
2025-05-11 16:23:02,257 - CipherShare Client - INFO - Session is valid
2025-05-11 16:23:10,045 - CipherShare Client - INFO - Registered as lamia
2025-05-11 16:23:11,074 - CipherShare Client - INFO - Session is valid
2025-05-11 16:23:57,180 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:23:57,181 - CipherShare Client - INFO - Encrypting 'testfile.txt' for secure storage (at rest)
2025-05-11 16:23:57,181 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 16:24:07,502 - CipherShare Client - INFO - Session is valid
2025-05-11 16:24:46,249 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:24:46,250 - CipherShare Client - INFO - Encrypting 'testfile.txt' for secure storage (at rest)
2025-05-11 16:24:46,329 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 16:24:46,335 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 16:24:46,336 - CipherShare Client - INFO -  Original file size: 24 bytes
2025-05-11 16:24:46,336 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 16:24:46,336 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 32 bytes)
2025-05-11 16:24:46,336 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 16:24:46,337 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 32 bytes)
2025-05-11 16:24:46,337 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: d4f6ce95d8073a2344b9fecea1dc9c8e)
2025-05-11 16:24:46,337 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\testfile.txt
2025-05-11 16:24:46,340 - CipherShare Client - INFO - Saved 1 shared files
2025-05-11 16:24:46,340 - CipherShare Client - INFO - File 'testfile.txt' uploaded successfully
2025-05-11 16:24:53,030 - CipherShare Client - INFO - Retrieved 2 available files
2025-05-11 16:24:59,748 - CipherShare Client - INFO - Session is valid
2025-05-11 16:25:02,414 - CipherShare Client - INFO - Retrieved 2 available files
2025-05-11 16:25:06,350 - CipherShare Client - INFO - ============================================================
2025-05-11 16:25:06,350 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 16:25:06,350 - CipherShare Client - INFO - ============================================================
2025-05-11 16:25:06,351 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 16:25:08,400 - CipherShare Client - ERROR -  Download request failed: File "test1.txt" found but all clients are unreachable
2025-05-11 16:25:13,822 - CipherShare Client - INFO - Session is valid
2025-05-11 16:25:17,035 - CipherShare Client - INFO - Session is valid
2025-05-11 16:25:20,927 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 16:25:22,507 - CipherShare Client - INFO - Session is valid
2025-05-11 16:25:33,731 - CipherShare Client - INFO - Session is valid
2025-05-11 16:25:35,308 - CipherShare Client - INFO - Retrieved 0 available files
2025-05-11 16:25:36,706 - CipherShare Client - INFO - Session is valid
2025-05-11 16:29:01,604 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:29:01,605 - CipherShare Client - INFO - Encrypting 'testfile2.txt' for secure storage (at rest)
2025-05-11 16:29:01,605 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 16:29:04,891 - CipherShare Client - INFO - Session is valid
2025-05-11 16:29:06,552 - CipherShare Client - INFO - Disconnected from server
2025-05-11 16:29:08,908 - CipherShare Client - INFO - Disconnected from server
2025-05-11 16:29:15,016 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-11 16:29:15,021 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 16:29:15,021 - CipherShare Client - INFO - Listening for file transfers on port 55254
2025-05-11 16:29:15,022 - CipherShare Client - INFO - Starting to listen for file transfers on port 55254
2025-05-11 16:29:17,810 - CipherShare Client - INFO - Loaded 1 shared files
2025-05-11 16:29:17,815 - CipherShare Client - INFO - Connected to server at localhost:5555
2025-05-11 16:29:17,815 - CipherShare Client - INFO - Listening for file transfers on port 55256
2025-05-11 16:29:17,816 - CipherShare Client - INFO - Starting to listen for file transfers on port 55256
2025-05-11 16:29:47,213 - CipherShare Client - INFO - Logged in as lamy
2025-05-11 16:29:54,228 - CipherShare Client - INFO - Logged in as lamia
2025-05-11 16:29:55,146 - CipherShare Client - INFO - Session is valid
2025-05-11 16:30:01,995 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:01,995 - CipherShare Client - INFO - Encrypting 'tests2.txt' for secure storage (at rest)
2025-05-11 16:30:02,083 - CipherShare Client - INFO - Derived AES encryption key using PBKDF2 with random salt
2025-05-11 16:30:02,090 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 16:30:02,091 - CipherShare Client - INFO -  Original file size: 6 bytes
2025-05-11 16:30:02,091 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 16:30:02,091 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 16:30:02,091 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 16:30:02,091 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 16:30:02,091 - CipherShare Client - INFO - File encrypted using AES-256-CBC (IV: 4845ebfee6874aed83f76397314a09c1)
2025-05-11 16:30:02,092 - CipherShare Client - INFO - Encrypted file stored securely at: shared_files\tests2.txt
2025-05-11 16:30:02,094 - CipherShare Client - INFO - Saved 2 shared files
2025-05-11 16:30:02,095 - CipherShare Client - INFO - File 'tests2.txt' uploaded successfully
2025-05-11 16:30:04,325 - CipherShare Client - INFO - Session is valid
2025-05-11 16:30:06,535 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 16:30:08,544 - CipherShare Client - INFO - Session is valid
2025-05-11 16:30:10,077 - CipherShare Client - INFO - Retrieved 1 available files
2025-05-11 16:30:11,896 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:11,896 - CipherShare Client - INFO -  STARTING SECURE FILE DOWNLOAD PROCESS
2025-05-11 16:30:11,896 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:11,897 - CipherShare Client - INFO -  Sending download request to server
2025-05-11 16:30:11,899 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 55258)
2025-05-11 16:30:11,899 - CipherShare Client - INFO -  Server provided file source: lamia at 127.0.0.1:55256
2025-05-11 16:30:11,899 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:11,899 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:11,899 - CipherShare Client - INFO -  ESTABLISHING CONNECTION TO FILE OWNER
2025-05-11 16:30:11,899 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 16:30:11,899 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:11,899 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 55258)
2025-05-11 16:30:11,899 - CipherShare Client - INFO -  Connected to file source at 127.0.0.1:55256
2025-05-11 16:30:11,899 - CipherShare Client - INFO -  Received request of type: FILE_INFO
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  Sent file transfer request for 'tests2.txt'
2025-05-11 16:30:11,899 - CipherShare Client - INFO - Received connection from ('127.0.0.1', 55259)
2025-05-11 16:30:11,901 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  File info request for upcoming transfer: {'type': 'FILE_INFO', 'requester_ip': '127.0.0.1', 'requester_port': 55253, 'requester_username': 'lamy', 'filename': 'tests2.txt'}
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE (RECEIVER)
2025-05-11 16:30:11,901 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  Initializing Diffie-Hellman key exchange
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  Sent acknowledgment
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  HANDLING INCOMING FILE TRANSFER REQUEST
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 16:30:11,901 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 55258)
2025-05-11 16:30:11,902 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:11,902 - CipherShare Client - INFO -  Received connection from ('127.0.0.1', 55259)
2025-05-11 16:30:11,902 - CipherShare Client - INFO -  Received request of type: FILE_TRANSFER
2025-05-11 16:30:11,902 - CipherShare Client - INFO -  File transfer request for 'tests2.txt' from lamy
2025-05-11 16:30:11,902 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:11,903 - CipherShare Client - INFO -   Decrypting file from disk (encrypted at rest)
2025-05-11 16:30:11,909 - CipherShare Client - INFO -  Extracted salt, IV, and ciphertext from disk
2025-05-11 16:30:11,924 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 16:30:11,925 - CipherShare Client - INFO -  Sent our public key to file owner
2025-05-11 16:30:11,925 - CipherShare Client - INFO -  Waiting for file owner's public key...
2025-05-11 16:30:11,988 - CipherShare Client - INFO -  Derived AES encryption key using PBKDF2 with salt from disk
2025-05-11 16:30:11,988 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 16:30:11,989 - CipherShare Client - INFO -  Encrypted file size: 16 bytes
2025-05-11 16:30:11,989 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 16:30:11,989 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 16 bytes)
2025-05-11 16:30:11,989 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 6 bytes)
2025-05-11 16:30:11,990 - CipherShare Client - INFO -  Successfully decrypted file from disk
2025-05-11 16:30:11,990 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:11,990 - CipherShare Client - INFO -  GENERATING FILE INTEGRITY HASH
2025-05-11 16:30:11,990 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 16:30:11,990 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 16:30:11,991 - CipherShare Client - INFO -  Generated SHA-256 hash
2025-05-11 16:30:11,991 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:11,991 - CipherShare Client - INFO -  INITIATING DIFFIE-HELLMAN KEY EXCHANGE
2025-05-11 16:30:11,991 - CipherShare Client - INFO -  Initializing Diffie-Hellman with 1024-bit parameters
2025-05-11 16:30:11,991 - CipherShare Client - INFO -  Generated private key (random number)
2025-05-11 16:30:12,009 - CipherShare Client - INFO -  Calculated public key using formula: g^private_key mod p
2025-05-11 16:30:12,009 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 16:30:12,009 - CipherShare Client - INFO -  Using peer's public key: 545... (showing last 3 digits)
2025-05-11 16:30:12,030 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 16:30:12,030 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 16:30:12,030 - CipherShare Client - INFO -  Computed shared DH session key
2025-05-11 16:30:12,030 - CipherShare Client - INFO -  Sent our DH public key
2025-05-11 16:30:12,031 - CipherShare Client - INFO -  Received file owner's public key
2025-05-11 16:30:12,031 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,031 - CipherShare Client - INFO -  Beginning shared key computation
2025-05-11 16:30:12,031 - CipherShare Client - INFO -  SENDING FILE HASH
2025-05-11 16:30:12,031 - CipherShare Client - INFO -  Using peer's public key: 268... (showing last 3 digits)
2025-05-11 16:30:12,031 - CipherShare Client - INFO -  Sent file hash
2025-05-11 16:30:12,032 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,032 - CipherShare Client - INFO -  Re-encrypting file with DH session key for transit
2025-05-11 16:30:12,032 - CipherShare Client - INFO -  Beginning file encryption with AES-256-CBC
2025-05-11 16:30:12,032 - CipherShare Client - INFO -  Original file size: 6 bytes
2025-05-11 16:30:12,033 - CipherShare Client - INFO -  Generated random 16-byte Initialization Vector (IV)
2025-05-11 16:30:12,033 - CipherShare Client - INFO -  Applied PKCS7 padding to data (padded size: 16 bytes)
2025-05-11 16:30:12,033 - CipherShare Client - INFO -  Created AES-256-CBC encryptor with the shared key
2025-05-11 16:30:12,033 - CipherShare Client - INFO -  Encrypted file data (encrypted size: 16 bytes)
2025-05-11 16:30:12,033 - CipherShare Client - INFO -  Re-encrypted file with DH key (length: 16 bytes)
2025-05-11 16:30:12,034 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,034 - CipherShare Client - INFO -  SENDING ENCRYPTED FILE
2025-05-11 16:30:12,034 - CipherShare Client - INFO -  File securely sent
2025-05-11 16:30:12,034 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:12,034 - CipherShare Client - INFO -  SECURE FILE TRANSFER COMPLETE
2025-05-11 16:30:12,034 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:12,034 - CipherShare Client - INFO -  Closed connection with ('127.0.0.1', 55259)
2025-05-11 16:30:12,058 - CipherShare Client - INFO -  Computed raw shared secret using formula: peer_public_key^private_key mod p
2025-05-11 16:30:12,058 - CipherShare Client - INFO -  Derived 256-bit encryption key using SHA-256 hash of shared secret
2025-05-11 16:30:12,059 - CipherShare Client - INFO -  Successfully computed shared encryption key
2025-05-11 16:30:12,059 - CipherShare Client - INFO -  DIFFIE-HELLMAN KEY EXCHANGE COMPLETED
2025-05-11 16:30:12,059 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,059 - CipherShare Client - INFO -  RECEIVING FILE INTEGRITY HASH
2025-05-11 16:30:12,059 - CipherShare Client - INFO -  Received file integrity hash from sender
2025-05-11 16:30:12,060 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,060 - CipherShare Client - INFO -  RECEIVING ENCRYPTED FILE
2025-05-11 16:30:12,060 - CipherShare Client - INFO -  Waiting for encrypted file data...
2025-05-11 16:30:12,060 - CipherShare Client - INFO -  Received encrypted file: 32 bytes
2025-05-11 16:30:12,060 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,061 - CipherShare Client - INFO -  DECRYPTING FILE
2025-05-11 16:30:12,061 - CipherShare Client - INFO -  Extracted IV (16 bytes) and ciphertext (16 bytes)
2025-05-11 16:30:12,061 - CipherShare Client - INFO -  Beginning file decryption with AES-256-CBC
2025-05-11 16:30:12,061 - CipherShare Client - INFO -  Encrypted file size: 16 bytes
2025-05-11 16:30:12,061 - CipherShare Client - INFO -  Created AES-256-CBC decryptor with the shared key
2025-05-11 16:30:12,061 - CipherShare Client - INFO -  Decrypted to padded data (padded size: 16 bytes)
2025-05-11 16:30:12,061 - CipherShare Client - INFO -  Removed PKCS7 padding from data (final size: 6 bytes)
2025-05-11 16:30:12,061 - CipherShare Client - INFO -  Successfully decrypted file (size: 6 bytes)
2025-05-11 16:30:12,062 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,062 - CipherShare Client - INFO -  VERIFYING FILE INTEGRITY
2025-05-11 16:30:12,062 - CipherShare Client - INFO -  Verifying file integrity with SHA-256 hash
2025-05-11 16:30:12,062 - CipherShare Client - INFO -  Calculating SHA-256 hash for file integrity
2025-05-11 16:30:12,062 - CipherShare Client - INFO -  Generated SHA-256 hash of file
2025-05-11 16:30:12,062 - CipherShare Client - INFO -  INTEGRITY VERIFIED: File hash matches expected value
2025-05-11 16:30:12,062 - CipherShare Client - INFO -  File integrity verified - hash matches!
2025-05-11 16:30:12,062 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,062 - CipherShare Client - INFO -  SAVING DECRYPTED FILE
2025-05-11 16:30:12,063 - CipherShare Client - INFO -  File saved to downloaded_files\tests2.txt
2025-05-11 16:30:12,063 - CipherShare Client - INFO - Saved 2 shared files
2025-05-11 16:30:12,063 - CipherShare Client - INFO -  Added file to shared files list
2025-05-11 16:30:12,064 - CipherShare Client - INFO -  Registering file as available from this client
2025-05-11 16:30:12,064 - CipherShare Client - INFO - --------------------------------------------------
2025-05-11 16:30:12,064 - CipherShare Client - INFO - Encrypting 'tests2.txt' for secure storage (at rest)
2025-05-11 16:30:12,065 - CipherShare Client - ERROR - Encryption or file preparation failed: Invalid padding bytes.
2025-05-11 16:30:12,065 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:12,065 - CipherShare Client - INFO -  SECURE FILE DOWNLOAD COMPLETED SUCCESSFULLY
2025-05-11 16:30:12,065 - CipherShare Client - INFO - ============================================================
2025-05-11 16:30:12,065 - CipherShare Client - INFO -  Closed connection to file owner
